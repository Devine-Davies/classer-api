let g={};const E=questionnaire.benefits,S=(e,r)=>g[e]=r,B=e=>g[e],x=e=>B(e)!==void 0,I=()=>{let e=0;const r=document.querySelectorAll("[data-question-block-idx]"),c=document.querySelectorAll('[id^="form-question-block-"]'),s=document.querySelector("[data-results]"),a=document.querySelector("[data-classer-billboard]"),l=document.querySelector("[data-submit]"),d=document.querySelector("[data-view-all-results]"),y=document.querySelector("[data-reset]"),i=document.querySelectorAll("[data-next-question]"),u=document.querySelectorAll("[data-previous-question]"),m=document.querySelectorAll("input[type=radio]");[...i,...u].forEach(t=>t.addEventListener("click",n=>{n.preventDefault();const o=t.getAttribute("data-next-question")!==null,h=o?e+1:e-1;if(o){if(!x(e)){alert("Please select an answer before proceeding");return}const q=Object.entries(questionnaire.weights);if(!T(q,g,h)){alert("No results available, please select an answer before proceeding");return}}p(h)})),l.addEventListener("click",t=>{t.preventDefault();const n=Object.entries(questionnaire.weights),o=k(n,g);f(o),R(g)}),m.forEach(t=>t.addEventListener("change",n=>{const o=parseInt(n.target.value);S(e,o)})),y.addEventListener("click",t=>{t.preventDefault(),g={},e=0,r.forEach(n=>n.classList.add("hidden")),c[e].classList.remove("hidden"),s.classList.add("hidden"),a.classList.add("hidden"),document.querySelectorAll("input[type=radio]").forEach(n=>{n.checked=!1})}),d.addEventListener("click",t=>{t.preventDefault(),d.remove(),document.querySelector(".acm-results-pane > ul").style.maxHeight="none"});const p=t=>{e=t,r.forEach((n,o)=>o===t?n.classList.remove("hidden"):n.classList.add("hidden"))},f=t=>{const n=Array.from({length:t.length});s.querySelector("ul").innerHTML=n.map((o,h)=>O(h)).join(""),setTimeout(()=>{s.querySelector("ul").innerHTML=t.map(w).join("");const o=s.querySelectorAll(".benefits-list");s.querySelectorAll("[data-toggle-open]").forEach(h=>{h.addEventListener("click",q=>{const v=q.target.getAttribute("data-toggle-open");o.forEach((b,A)=>A===parseInt(v)?b.classList.toggle("hidden"):b.classList.add("hidden"))})})},0),a.classList.remove("hidden"),s.classList.remove("hidden"),a.classList.remove("hidden"),r.forEach(o=>o.classList.add("hidden"))};c[e].classList.remove("hidden")};window.addEventListener("load",I);const T=(e,r,c)=>{const s=Object.entries(r).slice(0,c).reduce((a,[l,d])=>(a[l]=d,a),{});return k(e,s).length>0},k=(e,r)=>{const c=e.reduce((i,[u,m])=>{const p=m.map((t,n)=>t[r[n]]);if(p.includes("out"))return i;const f=p.reduce((t,n)=>t+n,0);return{...i,[u]:f}},{}),s=Object.entries(c),a=s.map(([,i])=>i),l=Math.max(...a),d=Math.min(...a),y=s.map(([i,u])=>{const m=l!==d?(u-d)/(l-d)*100:0;return{key:i,value:u,percentage:m,recommendationKey:j(m),recommendation:M(m)}});return y.sort((i,u)=>u.percentage-i.percentage),y},R=e=>{fetch("https://classermedia.com/api/site/actions-camera-matcher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:e,grc:document.querySelector("#grc-token").value})}).then()},j=e=>e>80?"highly-recommended":e>50?"good-match":"might-like",M=e=>e>80?"Highly recommend!":e>60?"It's a good match!":"You might like it!",H=e=>L(document.getElementById("template-acm-results-title").innerHTML,e),K=e=>{const r=E[e]||[],c=document.getElementById("template-acm-results-benefits-item").innerHTML;return`<ul>
        ${r.map(s=>L(c,{benefit:s})).join("")}
    </ul>`},w=(e,r,c=!0)=>{const s=document.getElementById("template-acm-results-item").innerHTML,a=e.recommendationKey==="might-like"?"":`<img class="absolute top-0 left-0 w-12 h-12 rounded-full" src="assets/images/action-camera-matcher/rankings/${e.recommendationKey}.svg">`,l={key:e.key,rankingImage:a,title:H(e),benefits:K(e.key),recommendation:e.recommendation,recommendationKey:e.recommendationKey,thumbnail:`assets/images/action-camera-matcher/cameras/${e.key}.jpg`};return L(s,l)},O=e=>w({key:"Fetching results...",recommendation:"Just a moment",recommendationKey:"might-like"},e,!1),L=(e,r)=>e.replace(/\${(.*?)}/g,(c,s)=>r[s.trim()]);
